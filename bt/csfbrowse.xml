<?xml version="1.0" encoding="utf-8"?>

<!-- This is an XForms+XHTML document for Baseline Tailor, a user interface for tailoring security controls, browsing the Cybersecurity Framework, and creating a Framework Profile. -->

<?xml-stylesheet href="xsltforms/xsltforms.xsl" type="application/xml"?>

<!DOCTYPE html [
<!-- User Guide URL -->
<!ENTITY doiurl "http://dx.doi.org/">
<!ENTITY btugdoi "10.6028/NIST.IR.8130">
<!ENTITY userguide "&doiurl;&btugdoi;">
]>

<html xmlns="http://www.w3.org/1999/xhtml" xmlns:html="http://www.w3.org/1999/xhtml"
	xmlns:xf="http://www.w3.org/2002/xforms" xmlns:xs="http://www.w3.org/2001/XMLSchema"
	xmlns:ev="http://www.w3.org/2001/xml-events">
	<head>
		
		<title>Cybersecurity Framework / SP 800-53 Browser</title>
		<link rel="shortcut icon" href="images/favicon.ico" />
		<link rel="stylesheet" href="styles.css" type="text/css" />
		
		<xf:model>
			
			<!-- Framework Core -->
			<xf:instance id="i-core" src="bt-model/core.xml" xmlns=""/>
			
			<!-- Used to construct itemset for category select1. Derived from core.xml -->
			<xf:instance id="i-cat-dropdown" src="bt-model/cat-dropdown.xml" xmlns=""/>
			
			<!-- Lists subcategories referencing each control. Used to create subcat buttons in Cross References tab -->
			<xf:instance id="i-families" src="bt-model/families.xml"/>
			
			<xf:instance id="i-xref" xmlns="">
				<xref>AC-1</xref>
			</xf:instance>
			
			<xf:instance id="i-version" xmlns="">
				<version>0.0.1</version>
			</xf:instance>
			
			<xf:instance id="i-updated" xmlns="">
				<updated/>
			</xf:instance>
			
			<xf:instance id="i-core-url" xmlns="">
				<data>
					<control/>
					<family/>
					<ics/>
					<icsFlag>false</icsFlag>
					<nvdurl>https://csrc.nist.gov/Projects/risk-management/sp800-53-controls/release-search#!/</nvdurl>
					<version>4.0</version>
				</data>
			</xf:instance>
						
			
			<!-- Captures the current Framework Core browser UI state. -->
			<xf:instance id="i-browse" xmlns="">
				<data>
					<function>
						<id>ID</id>
					</function>
					<category>
						<id>ID.AM</id>
						<description/>
					</category>
					<subcategory>
						<id>ID.AM-1</id>
						<description/>
					</subcategory>
					<crossRef>false</crossRef>
				</data>
			</xf:instance>
			
			<xf:bind ref="instance('i-browse')/category/description"
				calculate="instance('i-core')//description[../@id=instance('i-browse')/category/id]"/>
			
			<xf:bind ref="instance('i-browse')/subcategory/description"
				calculate="instance('i-core')//description[../@id=instance('i-browse')/subcategory/id]"/>
			
			<xf:bind ref="instance('i-browse')/crossRef"
				calculate="choose(not(substring-before(..,'.')=../../function/id and substring-before(..,'-')=../../category/id and ..=../../subcategory/id), false(), .)"
				type="xs:boolean"/>
			
			<xf:bind ref="instance('i-core-url')/ics" relevant="../icsFlag=true()"/>
			<xf:bind ref="instance('i-core-url')/icsFlag" type="xs:boolean"/>
			
			
		</xf:model>
		
	</head>
	<body>
		<h1>
			<img alt="needle and thread image" width="50" height="50"
				src="images/Needle_and_thread_silhouette.png" />
			<span class="SWTitle">CSF / SP 800-53 Browser</span>
			<span class="SWSubTitle">Version <xf:output ref="instance('i-version')"/>
			</span>
			<span class="Links">
				<a href="&userguide;" target="_blank">User Guide (PDF)</a> | <a href="LICENSE.txt"
					target="_blank">License</a> | <a href="index.html" target="_blank">Security
						Content and Tools</a>
			</span>
		</h1>

		<xf:switch>
			<xf:case id="case-hide-prefs" selected="true">
				<group>
					<xf:trigger>
						<xf:label>Preferences</xf:label>
						<xf:hint>Change user preferences.</xf:hint>
						<xf:toggle case="case-prefs" ev:event="DOMActivate"/>
					</xf:trigger>
				</group>
			</xf:case>
			<xf:case id="case-prefs" selected="false">
				<group>
					<xf:input ref="instance('i-core-url')/icsFlag" appearance="full">
						<xf:label><img src="images/factory.ico" alt="factory" /> NIST SP 800-82
							(Revision 2) Industrial Control Systems overlay: </xf:label>
					</xf:input>					
				</group><br/>
				<group>
					<xf:trigger>
						<xf:label>OK</xf:label>
						<xf:hint>Accept selections.</xf:hint>
						<xf:toggle case="case-hide-prefs" ev:event="DOMActivate"/>
					</xf:trigger>
				</group>
			</xf:case>
		</xf:switch>
		<br />
		<div id="horizontal-tab-menu">
			<xf:trigger id="tab-core" appearance="minimal">
				<xf:label class="TabText">Cyber Framework Browser</xf:label>
				<xf:toggle case="case-core" ev:event="DOMActivate"/>
			</xf:trigger>
			<xf:trigger id="tab-xref" appearance="minimal">
				<xf:label class="TabText">Cross References</xf:label>
				<xf:toggle case="case-xref" ev:event="DOMActivate"/>
			</xf:trigger>
		</div>
		<xf:switch>
			<xf:case id="case-core" selected="true">
				<div id="div-core">
					<xf:group ref="instance('i-browse')">
						<table>
							<tbody>
							<tr class="Row">
								<td class="Cell">
									<div class="Functions">
										<xf:select1 appearance="full"
											ref="function/id">
											<xf:label>Framework core function:<br /></xf:label>
											<xf:item>
												<xf:label class="ID">IDENTIFY (ID)</xf:label>
												<xf:value>ID</xf:value>
											</xf:item>
											<xf:item>
												<xf:label class="PR">PROTECT (PR)</xf:label>
												<xf:value>PR</xf:value>
											</xf:item>
											<xf:item>
												<xf:label class="DE">DETECT (DE)</xf:label>
												<xf:value>DE</xf:value>
											</xf:item>
											<xf:item>
												<xf:label class="RS">RESPOND (RS)</xf:label>
												<xf:value>RS</xf:value>
											</xf:item>
											<xf:item>
												<xf:label class="RC">RECOVER (RC)</xf:label>
												<xf:value>RC</xf:value>
											</xf:item>
											<!--<xf:action ev:event="xforms-value-changed"
												if="instance('i-browse')/crossRef=false()">
												<xf:setvalue ref="instance('i-browse')/category/id"
													value="instance('i-core')//category/@id[../../@id=instance('i-browse')/function/id]"/>
												<xf:setvalue
													ref="instance('i-browse')/category/description"
													value="instance('i-core')//category/description[../@id=instance('i-browse')/category/id]"
												/>-->
											<!--</xf:action>-->
										</xf:select1>
									</div>
								</td>
								<td>
									<table>
										<tbody>
										<tr>
											<td class="Cell">
												<xf:select1 ref="category/id"
													appearance="minimal">
													<xf:label>Category:<br /></xf:label>
													<xf:itemset
														nodeset="instance('i-cat-dropdown')//cat[substring-before(id, '.')=instance('i-browse')/function/id]">
														<xf:label ref="label"/>
														<xf:value ref="id"/>
													</xf:itemset>
													<!--<xf:action ev:event="xforms-value-changed"
														if="instance('i-browse')/crossRef=false()">
														<xf:setvalue
															ref="instance('i-browse')/subcategory/id"
															value="'ID.GV-1'"/>
													</xf:action>-->
												</xf:select1><br />
												<strong>
													<xf:output ref="category/id"/>
													<span>: </span>
												</strong>
												<xf:output ref="category/description"/>
											</td>
										</tr>
										<tr>
											<td class="Cell">
												<xf:group ref="subcategory">
													<xf:select1 appearance="minimal"
														ref="id">
														<xf:label>Subcategory:<br /></xf:label>
														<xf:itemset
															nodeset="instance('i-core')//subCategory[../@id=instance('i-browse')/category/id]">
															<xf:label ref="@id"/>
															<xf:value ref="@id"/>
														</xf:itemset>
													</xf:select1><br />
													<strong>
														<xf:output ref="id"/>
														<span>: </span>
													</strong>
													<xf:output ref="description"/><br />
												</xf:group>
											</td>
										</tr>
										</tbody>
									</table>
								</td>
							</tr>
							</tbody>
						</table>
						<p><xf:output ref="instance('i-browse')/subcategory/id"/> Informative
							References to NIST SP 800-53:</p>
						<xf:repeat id="reference-repeat"
							nodeset="instance('i-core')//subCategory[@id=instance('i-browse')/subcategory/id]/sp800-53/control">
							<table>
								<tbody>
								<tr>
									<td class="ControlButton">
										<xf:trigger>
											<xf:label ref="."/>
											<xf:hint>
												<span>Open security control </span>
												<xf:output ref="."/>
												<span> definition in a new browser tab.</span>
											</xf:hint>
											<xf:action ev:event="DOMActivate"
												submission="trigger-submission">
												<xf:setvalue ref="instance('i-core-url')/control"
													value="concat(instance('i-core-url')/nvdurl, 'control?version=', instance('i-core-url')/version, '&amp;', 'number=', context())"/>
												<xf:load show="new"
													ref="instance('i-core-url')/control"/>
											</xf:action>
										</xf:trigger>
									</td>
									<td>
										<xf:trigger ref="instance('i-core-url')/ics">
											<xf:label><img src="images/factory.ico" alt="factory"
											/></xf:label>
											<xf:hint>Open NIST SP 800-82 ICS Overlay tailoring for
												security control definition in a new browser
												tab.</xf:hint>
											<xf:action ev:event="DOMActivate">
												<xf:setvalue ref="instance('i-core-url')/ics"
													value="concat('ics/', instance('i-core')//subCategory[@id=instance('i-browse')/subcategory/id]/sp800-53/control[index('reference-repeat')], '.html')"/>
												<xf:load show="new" ref="instance('i-core-url')/ics"
												/>
											</xf:action>
										</xf:trigger>
									</td>
									<td>
										<xf:trigger>
											<xf:label><img src="images/link.ico" alt="link"
											/></xf:label>
											<xf:hint>
												<span>Show Framework Core subcategories referencing </span>
												<xf:output ref="context()"/>
												<span>.</span>
											</xf:hint>
											<xf:action ev:event="DOMActivate">
												<xf:setvalue ref="instance('i-xref')"
													value="context()"/>
												<xf:dispatch targetid="tab-xref" name="DOMActivate"
												/>
											</xf:action>
										</xf:trigger>
									</td>
								</tr>
								</tbody>
							</table>
						</xf:repeat>
					</xf:group>
				</div>
			</xf:case> 
			<xf:case id="case-xref" selected="false">
				<div id="div-xref">
					<xf:group>
						<span>Framework Core subcategories referencing control </span>
						<xf:output ref="instance('i-xref')"/>
						<span>:</span>
						<br />
						<xf:repeat
							nodeset="instance('i-families')//subcategory/@number[../../@number=instance('i-xref')]">
							<xf:trigger>
								<xf:label ref="."/>
								<xf:hint>
									<span>Show Framework Core </span>
									<xf:output ref="."/>
									<span> definition.</span>
								</xf:hint>
								<xf:action ev:event="DOMActivate">
									<xf:setvalue ref="instance('i-browse')/crossRef" value="context()"/>
									<xf:setvalue ref="instance('i-browse')/crossRef" value="true()"/>
									<xf:setvalue ref="instance('i-browse')/function/id" value="substring-before(../../crossRef,'.')"/>
									<xf:setvalue ref="instance('i-browse')/category/id" value="substring-before(../../crossRef,'-')"/>
									<xf:setvalue ref="instance('i-browse')/subcategory/id" value="../../crossRef">
									</xf:setvalue>
									<xf:dispatch targetid="tab-core" name="DOMActivate"/>
								</xf:action>
							</xf:trigger>
						</xf:repeat>
					</xf:group>
				</div>
			</xf:case>
		</xf:switch>
		<div class="footer">
			<p> Last updated: <xf:output ref="instance('i-updated')"/>
				<br /> Contact: <strong><a href="mailto:lubell@nist.gov">Joshua Lubell</a></strong>
			</p>
		</div>
	</body>
	
</html>
